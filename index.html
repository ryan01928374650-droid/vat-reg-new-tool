<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SBX VAT Registration Checker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { color-scheme: light; }
    body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; }
    .tip { position: absolute; display:none; z-index:20; right:0; top:1.75rem; width:16rem; font-size:.75rem;
           background:#fff; border:1px solid #e5e7eb; border-radius:.5rem; padding:.5rem; box-shadow:0 5px 15px rgba(0,0,0,.05); }
    .group:hover .tip { display:block; }
    .badge { font-size:.7rem; border-radius:.375rem; padding:.15rem .4rem; border:1px solid rgba(0,0,0,.08); }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-slate-100 text-slate-800">
  <header class="max-w-5xl mx-auto px-4 pt-10 pb-4 flex items-center justify-between">
    <div class="flex items-center gap-3">
      <div class="h-10 w-10 rounded-2xl bg-slate-900 text-white grid place-items-center font-bold">SBX</div>
      <div>
        <h1 class="text-xl sm:text-2xl font-semibold tracking-tight">VAT Registration Checker</h1>
        <p class="text-sm text-slate-500 -mt-0.5">Quick triage for compulsory VAT registration (UK)</p>
      </div>
    </div>
    <div class="hidden sm:block text-xs text-slate-500">"Small Business Experts"</div>
  </header>

  <main class="max-w-5xl mx-auto px-4 pb-16">
    <div class="grid md:grid-cols-2 gap-6">
      <!-- Inputs -->
      <section class="bg-white/80 backdrop-blur rounded-2xl shadow-sm ring-1 ring-slate-200 p-6">
        <h2 class="text-lg font-semibold mb-4">Inputs</h2>

        <div class="grid grid-cols-1 gap-4 text-sm">
          <label>Business name (optional)
            <input id="biz" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-slate-400">
          </label>

          <label>Industry
            <select id="industry" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-slate-400">
              <option>Trades / Construction</option>
              <option>Advanced Aesthetics / Beauty</option>
              <option>Medical / Healthcare</option>
              <option>Consultancy / Contracting</option>
              <option>IT & Software</option>
              <option>E-commerce / Retail</option>
              <option>Hospitality</option>
              <option>Property & Lettings</option>
              <option>Creative / Media</option>
              <option>Professional Services</option>
              <option>Manufacturing</option>
              <option>Charities / Non-profit</option>
              <option>Education / Training</option>
              <option>Transport / Logistics</option>
              <option>Agriculture / Farming</option>
              <option>Other</option>
            </select>
          </label>

          <label>Rolling 12-month turnover — all supplies (gross, excl. VAT)
            <input id="turn12" type="number" min="0" step="100" value="80000" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-slate-400">
          </label>

          <div class="grid grid-cols-3 gap-3">
            <label class="flex flex-col">% Standard-rated
              <div class="relative group">
                <input id="pctStd" type="number" min="0" max="100" step="0.5" value="100" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-slate-400">
                <span class="absolute right-2 top-3 text-slate-400 text-xs border border-slate-300 rounded-full w-5 h-5 grid place-items-center cursor-help">i</span>
                <div class="tip"><b>Standard-rated (20%)</b>: most goods/services. Counts toward the threshold. You charge 20% and can usually reclaim input VAT.</div>
              </div>
            </label>
            <label class="flex flex-col">% Zero-rated
              <div class="relative group">
                <input id="pctZero" type="number" min="0" max="100" step="0.5" value="0" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-slate-400">
                <span class="absolute right-2 top-3 text-slate-400 text-xs border border-slate-300 rounded-full w-5 h-5 grid place-items-center cursor-help">i</span>
                <div class="tip"><b>Zero-rated (0%)</b>: still taxable for the threshold (e.g., some food, children’s clothes). Input VAT is generally reclaimable.</div>
              </div>
            </label>
            <label class="flex flex-col">% Exempt
              <div class="relative group">
                <input id="pctExempt" type="number" min="0" max="100" step="0.5" value="0" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-slate-400">
                <span class="absolute right-2 top-3 text-slate-400 text-xs border border-slate-300 rounded-full w-5 h-5 grid place-items-center cursor-help">i</span>
                <div class="tip"><b>Exempt</b>: does not count toward the threshold (e.g., many financial/education/medical services). Input VAT recovery is restricted.</div>
              </div>
            </label>
          </div>
          <p class="text-xs text-slate-600 -mt-2">Most UK businesses are <b>standard-rated</b>. <b>Zero-rated</b> sales are still <i>taxable</i> for the threshold; <b>exempt</b> are not.</p>
          <div id="mixWarn" class="hidden text-xs -mt-1 text-amber-700 bg-amber-50 border border-amber-200 rounded-lg p-2"></div>

          <label class="flex flex-col">Expected taxable sales in next 30 days (standard + zero-rated, excl. VAT)
            <input id="next30" type="number" min="0" step="100" value="5000" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-slate-400">
            <span class="mt-1 text-xs text-slate-500">
              <span class="badge">Future test</span> We check <b>last 11 months (estimated) + next 30 days</b> against the £90k threshold.
            </span>
          </label>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <label>Avg monthly taxable sales (optional)
              <input id="avgMonthly" type="number" min="0" step="100" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-slate-400" placeholder="auto from 12m">
              <p class="text-xs text-slate-500 mt-1">Defaults to your current run-rate (taxable 12m ÷ 12).</p>
            </label>
            <label>Expected monthly growth % (optional)
              <input id="growthPct" type="number" min="-100" step="1" value="0" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-slate-400">
              <p class="text-xs text-slate-500 mt-1">Used only for the forecast (planning aid).</p>
            </label>
          </div>

          <label>Annual VAT you expect to reclaim (optional, £ of VAT — not gross cost)
            <input id="vatCosts" type="number" min="0" step="50" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-slate-400">
            <p class="text-xs text-slate-500 mt-1">If blank, we’ll use a cautious heuristic.</p>
          </label>

          <label>Notes (optional)
            <textarea id="notes" rows="3" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-slate-400"></textarea>
          </label>
        </div>
      </section>

      <!-- Output -->
      <section class="bg-white/80 backdrop-blur rounded-2xl shadow-sm ring-1 ring-slate-200 p-6 flex flex-col">
        <h2 class="text-lg font-semibold mb-4">Assessment</h2>
        <div id="statusBox" class="rounded-xl ring-1 px-4 py-3 mb-4 bg-emerald-500/10 text-emerald-700 ring-emerald-400/40">
          <div id="statusLabel" class="text-sm font-semibold">No compulsory registration yet</div>
          <div id="statusDetail" class="text-xs opacity-80 mt-0.5">Your taxable turnover is below the £90,000 threshold. Keep monitoring your rolling 12-month figures.</div>
        </div>

        <div class="grid grid-cols-2 gap-3 text-sm">
          <div class="rounded-xl border border-slate-200 p-3">
            <div class="text-slate-500 text-xs">Taxable turnover (rolling 12m)</div>
            <div id="tt12" class="text-base font-semibold">£0</div>
            <div class="text-xs text-slate-500 mt-1">Threshold: £90,000</div>
          </div>
          <div class="rounded-xl border border-slate-200 p-3">
            <div class="text-slate-500 text-xs">Future test (last 11m est. + next 30d)</div>
            <div id="futureTest" class="text-base font-semibold">£0</div>
            <div class="text-xs text-slate-500 mt-1">Must register if ≥ £90,000</div>
          </div>
        </div>

        <div class="grid grid-cols-3 gap-3 text-sm mt-3">
          <div class="rounded-xl border border-slate-200 p-3">
            <div class="text-slate-500 text-xs">Mix</div>
            <div id="mix" class="text-base font-semibold">100.0% std / 0.0% zero / 0.0% exempt</div>
            <div class="text-xs text-slate-500 mt-1">Sum: <span id="mixSum">100</span>%</div>
          </div>
          <div class="rounded-xl border border-slate-200 p-3">
            <div class="text-slate-500 text-xs">Est. output VAT (illustrative)</div>
            <div id="outVat" class="text-base font-semibold">£0</div>
            <div class="text-xs text-slate-500 mt-1">Assumes 20% on standard-rated sales</div>
          </div>
          <div class="rounded-xl border border-slate-200 p-3">
            <div class="text-slate-500 text-xs">Est. input VAT recoverable</div>
            <div id="inVat" class="text-base font-semibold">£0</div>
            <div class="text-xs text-slate-500 mt-1">User input or heuristic</div>
          </div>
        </div>

        <div class="mt-3 rounded-xl border border-slate-200 p-3 text-sm">
          <div class="text-slate-500 text-xs">Simple forecast</div>
          <div id="forecast" class="text-base font-semibold">Not enough monthly taxable sales to project a date yet.</div>
          <div class="text-xs text-slate-500 mt-1">Uses taxable monthly sales and monthly growth (compounded). Planning aid only.</div>
        </div>

        <div id="pexNote" class="hidden mt-3 text-xs text-violet-800 bg-violet-50 border border-violet-200 rounded-xl p-3"></div>

        <div class="mt-4 flex flex-wrap gap-2">
          <button id="copyBtn" class="px-4 py-2 rounded-xl bg-slate-900 text-white text-sm hover:opacity-90 active:scale-95">Copy summary</button>
          <button onclick="window.print()" class="px-4 py-2 rounded-xl border border-slate-300 text-sm hover:bg-slate-50">Print / Save PDF</button>
        </div>

        <div class="mt-6 text-xs text-slate-500">
          This tool provides general guidance only and does not constitute tax advice. VAT rules vary by sector. For personalised advice, contact SBX Accountants.
        </div>
      </section>
    </div>

    <section id="contact" class="mt-8">
      <div class="bg-white/80 backdrop-blur rounded-2xl shadow-sm ring-1 ring-slate-200 p-6">
        <h3 class="text-lg font-semibold mb-2">Next steps with SBX</h3>
        <p class="text-sm text-slate-600 mb-4">Want us to sanity-check your position or handle registration? We’ll confirm whether you must register now and set you up for smooth VAT returns.</p>
        <ul class="text-sm list-disc pl-5 text-slate-700 space-y-1">
          <li>Threshold monitoring template (rolling 12 months)</li>
          <li>Sector-specific VAT treatment guidance (e.g., aesthetics, trades)</li>
          <li>Partial exemption review if needed</li>
        </ul>
        <div class="mt-4 flex gap-2">
          <a href="mailto:ryan@sbxaccountants.com?subject=VAT%20Checker%20Follow-up" class="px-4 py-2 rounded-xl bg-slate-900 text-white text-sm hover:opacity-90">Email SBX</a>
          <a href="tel:+442070461730" class="px-4 py-2 rounded-xl border border-slate-300 text-sm hover:bg-slate-50">Call 020 7046 1730</a>
        </div>
      </div>
    </section>
  </main>

  <footer class="max-w-5xl mx-auto px-4 pb-10 pt-6 text-xs text-slate-500">
    © <span id="year"></span> SBX Accountants — VAT Registration Checker (Single-file)
  </footer>

  <script>
    const THRESHOLD = 90000;
    const GBP = (n) => new Intl.NumberFormat('en-GB', { style: 'currency', currency: 'GBP', maximumFractionDigits: 0 }).format(Number(n)||0);
    const pctfmt = (n) => ((Number(n) || 0).toFixed(1) + '%');

    // Closed-form months to reach remaining with monthly growth g
    function monthsToHit(remaining, m0, g) {
      if (remaining <= 0) return 0;
      if ((m0 || 0) <= 0 && (g || 0) <= 0) return null;
      const gg = Number(g) || 0;
      if (gg > 0 && m0 > 0) {
        const k = Math.ceil(Math.log((remaining * gg) / m0 + 1) / Math.log(1 + gg));
        return (isFinite(k) && k > 0) ? k : null;
      }
      if (gg === 0 && m0 > 0) return Math.ceil(remaining / m0);
      // negative growth fallback
      let sum = 0, n = 0, mk = m0;
      while (n < 120 && sum < remaining && mk > 0) { n++; sum += mk; mk *= (1 + gg); }
      return (sum >= remaining) ? n : null;
    }

    function compute() {
      const turn12 = Number(document.getElementById('turn12').value) || 0;
      const std = Number(document.getElementById('pctStd').value) || 0;
      const zero = Number(document.getElementById('pctZero').value) || 0;
      const ex = Number(document.getElementById('pctExempt').value) || 0;
      const next30 = Number(document.getElementById('next30').value) || 0;
      const avgMonthlyInput = Number(document.getElementById('avgMonthly').value);
      const hasAvg = !isNaN(avgMonthlyInput) && document.getElementById('avgMonthly').value !== '';
      const growthPct = Number(document.getElementById('growthPct').value) || 0;

      // Mix check
      const mixSum = std + zero + ex;
      const mixWarn = document.getElementById('mixWarn');
      if (mixSum !== 100) { mixWarn.classList.remove('hidden'); mixWarn.textContent = `Heads up: your rate mix adds to ${mixSum}%. Adjust so Standard + Zero + Exempt = 100%.`; }
      else { mixWarn.classList.add('hidden'); }

      // Taxable = standard + zero
      const taxablePct = (std + zero) / 100;
      const taxable12 = turn12 * taxablePct;

      // Average taxable/month for estimation and forecast
      const avgTaxableMonthly = hasAvg ? avgMonthlyInput : (taxable12 / 12);
      document.getElementById('avgMonthly').placeholder = `e.g. ${Math.round(taxable12 / 12)}`;

      // Future test = prior 11 months (estimated by average) + expected next 30 days
      const prior11_est = Math.max(0, taxable12 - avgTaxableMonthly);
      const futureTotal = prior11_est + next30;

      // VAT illustrations (very rough)
      const outVAT = (turn12 * (std/100)) * 0.20;
      const inVAT = (Number(document.getElementById('vatCosts').value) > 0)
        ? Number(document.getElementById('vatCosts').value)
        : (turn12 * 0.06);

      // Update UI blocks
      document.getElementById('tt12').textContent = GBP(taxable12);
      document.getElementById('futureTest').textContent = GBP(futureTotal);
      document.getElementById('mix').textContent = `${pctfmt(std)} std / ${pctfmt(zero)} zero / ${pctfmt(ex)} exempt`;
      document.getElementById('mixSum').textContent = mixSum;
      document.getElementById('outVat').textContent = GBP(Math.round(outVAT));
      document.getElementById('inVat').textContent = GBP(Math.round(inVAT));

      const pex = document.getElementById('pexNote');
      if (ex > 0) { pex.classList.remove('hidden'); pex.textContent = ex >= 50 ? 'High proportion of exempt supplies — likely partially exempt with limited input VAT recovery.' : 'Some exempt supplies present — partial exemption may restrict input VAT recovery.'; }
      else { pex.classList.add('hidden'); }

      // Status banner with amber for BOTH tests when within 10%
      const box = document.getElementById('statusBox');
      const label = document.getElementById('statusLabel');
      const detail = document.getElementById('statusDetail');
      box.className = box.className.replace(/bg-(red|amber|emerald).*?text-.*?ring-.*?/g, '');

      if (taxable12 >= THRESHOLD) {
        label.textContent = 'Register now (12-month test breached)';
        detail.textContent = 'Your taxable turnover over the past 12 months exceeds £90,000.';
        box.className += ' bg-red-600/10 text-red-700 ring-red-400/40';
      } else if (futureTotal >= THRESHOLD) {
        label.textContent = 'Register now (future test: last 11m + next 30d breached)';
        detail.textContent = 'Your prior 11 months (estimated) plus the next 30 days is expected to exceed £90,000.';
        box.className += ' bg-red-600/10 text-red-700 ring-red-400/40';
      } else if (taxable12 >= THRESHOLD * 0.9 || futureTotal >= THRESHOLD * 0.9) {
        label.textContent = 'Borderline — monitor closely';
        detail.textContent = 'You’re within 10% of the threshold on current or projected figures. Track weekly.';
        box.className += ' bg-amber-500/10 text-amber-700 ring-amber-400/40';
      } else {
        label.textContent = 'No compulsory registration yet';
        detail.textContent = 'Your taxable turnover is below the £90,000 threshold. Keep monitoring your rolling 12-month figures.';
        box.className += ' bg-emerald-500/10 text-emerald-700 ring-emerald-400/40';
      }

      // Forecast (planning aid): months until £90k using avg + growth.
      // If the FUTURE TEST already shows a breach next month, force forecast to "1 month".
      const remaining = Math.max(0, THRESHOLD - taxable12);
      let forecastText = 'Not enough monthly taxable sales to project a date yet.';
      if (taxable12 >= THRESHOLD) {
        forecastText = 'Already at/over the threshold on current inputs.';
      } else if (futureTotal >= THRESHOLD) {
        forecastText = 'Approx 1 month(s) to hit £90,000 at your run-rate.';
      } else if (avgTaxableMonthly > 0 || growthPct > 0) {
        const g = (growthPct || 0) / 100;
        const months = monthsToHit(remaining, avgTaxableMonthly, g);
        forecastText = (months != null)
          ? `Approx ${months} month(s) to hit £90,000 at your run-rate.`
          : 'Not enough monthly taxable sales to project a date yet.';
      }
      document.getElementById('forecast').textContent = forecastText;

      // Save for copy
      window.__sbx = {
        turn12, std, zero, ex, taxable12,
        next30, futureTotal,
        business: document.getElementById('biz').value || '(not provided)',
        industry: document.getElementById('industry').value,
        notes: document.getElementById('notes').value || 'n/a',
        outVAT, inVAT
      };
    }

    function copySummary() {
      const s = window.__sbx || {};
      const lines = [
        'SBX VAT Registration Checker — Summary',
        `Business: ${s.business || '(not provided)'}`,
        `Industry: ${s.industry || ''}`,
        `Rolling 12-month turnover (all supplies): ${GBP(s.turn12||0)}`,
        `Taxable mix assumed: ${(s.std||0).toFixed?.(1)||s.std||0}% standard / ${(s.zero||0).toFixed?.(1)||s.zero||0}% zero / ${(s.ex||0).toFixed?.(1)||s.ex||0}% exempt`,
        `Taxable turnover for threshold (12m): ${GBP(s.taxable12||0)}`,
        `Future test (last 11m est. + next 30d): ${GBP(s.futureTotal||0)}`,
        `Est. output VAT (illustrative): ${GBP(Math.round(s.outVAT||0))}`,
        `Est. input VAT recoverable (assumed): ${GBP(Math.round(s.inVAT||0))}`,
        `Notes: ${s.notes}`,
        '',
        'General guidance only — not tax advice.'
      ];
      const summary = lines.join("\n");
      navigator.clipboard.writeText(summary).then(() => {
        alert('Summary copied to clipboard ✔');
      }).catch(() => {
        alert('Couldn’t copy automatically — select and copy the on-screen text.');
      });
    }

    // wire up
    ['biz','industry','turn12','pctStd','pctZero','pctExempt','next30','avgMonthly','growthPct','vatCosts','notes']
      .forEach(id => document.getElementById(id).addEventListener('input', compute));
    document.getElementById('copyBtn').addEventListener('click', copySummary);
    document.getElementById('year').textContent = new Date().getFullYear();
    compute();
  </script>
</body>
</html>
